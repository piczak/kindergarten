<?php

namespace App\Component;

/**
 * Class Centile
 */
class Centile
{
    /**
     * @var integer Kobieta
     */
    const FEMALE = 'F';

    /**
     * @var integer Mężczyzna
     */
    const MALE = 'M';

    /**
     * @var \DateTime
     */
    protected $birthdayAt;

    /**
     * @var \DateTime
     */
    protected $examAt;

    /**
     * @var
     */
    protected $sex;

    /**
     * @var
     */
    protected $height;

    /**
     * @var
     */
    protected $weight;

    /**
     * @var
     */
    protected $shrinkPressure;

    /**
     * @var
     */
    protected $diastolicPressure;

    /**
     * @param \DateTime $birhdayAt
     *
     * @return $this
     */
    public function setBirthdayAt(\DateTime $birhdayAt)
    {
        $this->birthdayAt = $birhdayAt;

        return $this;
    }

    /**
     * @return \DateTime
     */
    public function getBirthdayAt()
    {
        return $this->birthdayAt;
    }

    /**
     * @param \DateTime $examAt
     *
     * @return $this
     */
    public function setExamAt(\DateTime $examAt)
    {
        $this->examAt = $examAt;

        return $this;
    }

    /**
     * @return \DateTime
     */
    public function getExamAt()
    {
        return $this->examAt;
    }

    /**
     * @param null $sex
     *
     * @return $this
     */
    public function setSex($sex = null)
    {
        $this->sex = $sex;

        return $this;
    }

    /**
     * @return mixed
     */
    public function getSex()
    {
        return $this->sex;
    }

    /**
     * @param null $height
     *
     * @return $this
     */
    public function setHeight($height = null)
    {
        $this->height = $height;

        return $this;
    }

    /**
     * @return mixed
     */
    public function getHeight()
    {
        return $this->height;
    }

    /**
     * @param null $weight
     *
     * @return $this
     */
    public function setWeight($weight = null)
    {
        $this->weight = $weight;

        return $this;
    }

    /**
     * @return mixed
     */
    public function getWeight()
    {
        return $this->weight;
    }

    /**
     * @param null $pressure
     *
     * @return $this
     */
    public function setShrinkPressure($pressure = null)
    {
        $this->shrinkPressure = $pressure;

        return $this;
    }

    /**
     * @return mixed
     */
    public function getShrinkPressure()
    {
        return $this->shrinkPressure;
    }

    /**
     * @param null $pressure
     *
     * @return $this
     */
    public function setDiastolicPressure($pressure = null)
    {
        $this->diastolicPressure = $pressure;

        return $this;
    }

    /**
     * @return mixed
     */
    public function getDiastolicPressure()
    {
        return $this->diastolicPressure;
    }

    /**
     * @return float
     */
    public function getBmiCentile()
    {
        $intervalAge = $this->calculateAgeInterval();

        $bmi = $this->getBmi();

        $lms = $this->getBmiLms($intervalAge, $this->sex);

        $value = $this->dec(
            $this->calculateCentile(
                $this->calculateZScore(
                    $bmi,
                    $lms['L'],
                    $lms['M'],
                    $lms['S']
                )
            ),
            0
        );

        if ($value == 0) {
            $value = 0.1;
        } else if ($value == 100) {
            $value = 99.9;
        }

        return $value;
    }

    /**
     * @return float
     */
    public function getHeightCentile()
    {
        $intervalAge = $this->calculateAgeInterval();

        $lms = $this->getHeightLms($intervalAge, $this->sex);

        $value = $this->dec(
            $this->calculateCentile(
                $this->calculateZScore(
                    $this->height,
                    $lms['L'],
                    $lms['M'],
                    $lms['S']
                )
            ),
            0
        );

        if ($value == 0) {
            $value = 0.1;
        } else if ($value == 100) {
            $value = 99.9;
        }

        return $value;
    }

    /**
     * @return float
     */
    public function getWeightCentile()
    {
        $intervalAge = $this->calculateAgeInterval();

        $lms = $this->getWeightLms($intervalAge, $this->sex);

        $value = $this->dec(
            $this->calculateCentile(
                $this->calculateZScore(
                    $this->weight,
                    $lms['L'],
                    $lms['M'],
                    $lms['S']
                )
            ),
            0
        );

        if ($value == 0) {
            $value = 0.1;
        } else if ($value == 100) {
            $value = 99.9;
        }

        return $value;
    }

    /**
     * @return float
     */
    public function getShrinkPressureCentile()
    {
        $intervalAge = $this->calculateAgeInterval();

        $lms = $this->getSbpLms($intervalAge, $this->sex);

        $value = $this->dec(
            $this->calculateCentile(
                $this->calculateZScore(
                    $this->shrinkPressure,
                    $lms['L'],
                    $lms['M'],
                    $lms['S']
                )
            ),
            0
        );

        if ($value == 0) {
            $value = 0.1;
        } else if ($value == 100) {
            $value = 99.9;
        }

        return $value;
    }

    /**
     * @return float
     */
    public function getDiastolicPressureCentile()
    {
        $intervalAge = $this->calculateAgeInterval();

        $lms = $this->getDbpLms($intervalAge, $this->sex);

        $value = $this->dec(
            $this->calculateCentile(
                $this->calculateZScore(
                    $this->diastolicPressure,
                    $lms['L'],
                    $lms['M'],
                    $lms['S']
                )
            ),
            0
        );

        if ($value == 0) {
            $value = 0.1;
        } else if ($value == 100) {
            $value = 99.9;
        }

        return $value;
    }

    /**
     * Obliczanie BMI
     *
     * @return float
     */
    public function getBmi()
    {
        $k = $this->height / 100;

        $bmi = $this->dec(($this->weight / ($k * $k)), 1);

        return $bmi;
    }

    /**
     * Obliczanie wieku pacjenta
     *
     * @return float|string
     */
    protected function calculateAge()
    {
        //Data urodzenia
        $bd = (int)$this->birthdayAt->format('d');
        $bm = (int)$this->birthdayAt->format('m');
        $by = (int)$this->birthdayAt->format('Y');

        //Data badania
        $md = (int)$this->examAt->format('d');
        $mm = (int)$this->examAt->format('m');
        $my = (int)$this->examAt->format('Y');

        //Obliczony wiek
        if ($mm < $bm) {
            $my = $my - 1;
            $mm = $mm + 12;
        }

        $age = (($md - $bd) + ($mm - $bm) * 30.5 + ($my - $by) * 30.5 * 12) / 365.25;

        return $age;
    }

    /**
     * @return int
     */
    protected function calculateAgeInterval()
    {
        $age = $this->calculateAge();

        $tabTemp  = [];
        $elementx = 0;
        $array    = [
            6.5, 6.583, 6.667, 6.75, 6.833, 6.917,
            7, 7.083, 7.167, 7.25, 7.333, 7.417, 7.5, 7.583, 7.667, 7.75, 7.833, 7.917,
            8, 8.083, 8.167, 8.25, 8.333, 8.417, 8.5, 8.583, 8.667, 8.75, 8.833, 8.917,
            9, 9.083, 9.167, 9.25, 9.333, 9.417, 9.5, 9.583, 9.667, 9.75, 9.833, 9.917,
            10, 10.083, 10.167, 10.25, 10.333, 10.417, 10.5, 10.583, 10.667, 10.75, 10.833, 10.917,
            11, 11.083, 11.167, 11.25, 11.333, 11.417, 11.5, 11.583, 11.667, 11.75, 11.833, 11.917,
            12, 12.083, 12.167, 12.25, 12.333, 12.417, 12.5, 12.583, 12.667, 12.75, 12.833, 12.917,
            13, 13.083, 13.167, 13.25, 13.333, 13.417, 13.5, 13.583, 13.667, 13.75, 13.833, 13.917,
            14, 14.083, 14.167, 14.25, 14.333, 14.417, 14.5, 14.583, 14.667, 14.75, 14.833, 14.917,
            15, 15.083, 15.167, 15.25, 15.333, 15.417, 15.5, 15.583, 15.667, 15.75, 15.833, 15.917,
            16, 16.083, 16.167, 16.25, 16.333, 16.417, 16.5, 16.583, 16.667, 16.75, 16.833, 16.917,
            17, 17.167, 17.25, 17.333, 17.417, 17.5, 17.583, 17.667, 17.75, 17.833, 17.917,
            18, 18.083, 18.167, 18.25, 18.333, 18.417, 18.5
        ];

        for ($i = 0; $i < 144; $i += 1) {
            $tabTemp[$i] = abs($array[$i] - $age);
        }

        $mini = 50.123;
        for ($i = 0; $i < 144; $i++) {
            if ($mini > $tabTemp[$i]) {
                $mini     = $tabTemp[$i];
                $elementx = $i;
            }
        }

        return $elementx;
    }

    /**
     * @param     $elementx
     * @param int $sex
     *
     * @return array
     */
    protected function getBmiLms($elementx, $sex = self::FEMALE)
    {
        $boyLBmi = [
            -2.25569 - 2.25045, -2.24521, -2.23996, -2.2347, -2.22943, -2.22415,
            -2.21885, -2.21353, -2.20821, -2.20288, -2.19754, -2.19219, -2.18683,
            -2.18146, -2.17608, -2.17069, -2.1653, -2.15991, -2.15452, -2.14912,
            -2.14372, -2.13831, -2.13289, -2.12745, -2.12199, -2.11652, -2.11102,
            -2.10551, -2.09997, -2.09442, -2.08885, -2.08327, -2.07768, -2.07208,
            -2.06647, -2.06086, -2.05525, -2.04962, -2.04399, -2.03835, -2.03269,
            -2.02701, -2.02132, -2.0156, -2.00986, -2.00409, -1.9983, -1.99247,
            -1.98661, -1.98073, -1.97481, -1.96887, -1.96289, -1.9569, -1.95088,
            -1.94483, -1.93875, -1.93264, -1.9265, -1.92034, -1.91414, -1.90792,
            -1.90166, -1.89537, -1.88905, -1.88268, -1.87626, -1.8698, -1.8633,
            -1.85674, -1.85015, -1.8435, -1.83682, -1.83009, -1.82332, -1.81651,
            -1.80966, -1.80277, -1.79584, -1.78887, -1.78188, -1.77487, -1.76783,
            -1.76077, -1.75369, -1.74659, -1.73945, -1.73228, -1.72508, -1.71784,
            -1.71055, -1.70323, -1.69587, -1.68847, -1.68104, -1.67357, -1.66607,
            -1.65855, -1.651, -1.64343, -1.63584, -1.62823, -1.62059, -1.61292,
            -1.60521, -1.59747, -1.58968, -1.58186, -1.574, -1.5661, -1.55816,
            -1.55018, -1.54216, -1.53411, -1.52603, -1.51792, -1.50979, -1.50165,
            -1.49349, -1.48532, -1.47716, -1.469, -1.46086, -1.45274, -1.44464,
            -1.43656, -1.4285, -1.42047, -1.41247, -1.40449, -1.39654, -1.38862,
            -1.38074, -1.37289, -1.36507, -1.35728, -1.34952, -1.34178, -1.33406,
            -1.32636, -1.31868, -1.311, -1.30334, -1.29568
        ];

        $boyMBMI = [
            15.58724, 15.62165, 15.65613, 15.69069, 15.72535, 15.76013, 15.79505,
            15.8301, 15.86529, 15.90057, 15.93593, 15.97137, 16.0069, 16.04253,
            16.07827, 16.11409, 16.14994, 16.1858, 16.22166, 16.25753, 16.2934,
            16.32932, 16.36533, 16.40144, 16.43768, 16.47406, 16.51061, 16.54733,
            16.58422, 16.62129, 16.65852, 16.69588, 16.73334, 16.77086, 16.80839,
            16.84593, 16.88348, 16.92104, 16.95861, 16.99621, 17.03386, 17.07162,
            17.1095, 17.14751, 17.18568, 17.22404, 17.2626, 17.30139, 17.34042,
            17.3797, 17.41921, 17.45895, 17.49888, 17.539, 17.5793, 17.61976,
            17.66042, 17.70129, 17.74235, 17.7836, 17.82504, 17.86666, 17.90846,
            17.95047, 17.99274, 18.03531, 18.07821, 18.12146, 18.16509, 18.20911,
            18.25352, 18.29831, 18.34345, 18.38892, 18.43472, 18.48086, 18.52734,
            18.57414, 18.62123, 18.66855, 18.71607, 18.76374, 18.81147, 18.85923,
            18.907, 18.95479, 19.00264, 19.05065, 19.09888, 19.14737, 19.19616,
            19.24526, 19.2947, 19.34445, 19.39449, 19.4448, 19.49535, 19.54609,
            19.59696, 19.64792, 19.69896, 19.75006, 19.80129, 19.85272, 19.90443,
            19.95647, 20.0089, 20.06176, 20.11509, 20.16891, 20.22325, 20.27813,
            20.33354, 20.38946, 20.44584, 20.50265, 20.55982, 20.61729, 20.67498,
            20.7328, 20.79065, 20.84839, 20.90591, 20.96312, 21.01993, 21.0763,
            21.13222, 21.18767, 21.24268, 21.29722, 21.35125, 21.40475, 21.45768,
            21.51003, 21.56182, 21.61308, 21.66383, 21.71413, 21.76405, 21.81362,
            21.86289, 21.9119, 21.96072, 22.00939, 22.05796
        ];

        $boySBMI = [
            0.11421, 0.11503, 0.11585, 0.11668, 0.1175, 0.11834, 0.11917, 0.12001,
            0.12086, 0.12171, 0.12256, 0.12342, 0.12428, 0.12515, 0.12601, 0.12688,
            0.12775, 0.12862, 0.12949, 0.13036, 0.13123, 0.13209, 0.13296, 0.13382,
            0.13467, 0.13553, 0.13637, 0.13721, 0.13804, 0.13886, 0.13967, 0.14047,
            0.14126, 0.14203, 0.14278, 0.14351, 0.14423, 0.14493, 0.14561, 0.14627,
            0.14691, 0.14753, 0.14813, 0.1487, 0.14926, 0.14979, 0.1503, 0.15079,
            0.15125, 0.1517, 0.15212, 0.15251, 0.15288, 0.15323, 0.15355, 0.15385,
            0.15412, 0.15436, 0.15457, 0.15475, 0.15491, 0.15503, 0.15512, 0.15517,
            0.15519, 0.15518, 0.15513, 0.15505, 0.15494, 0.15479, 0.15461, 0.1544,
            0.15415, 0.15388, 0.15358, 0.15325, 0.15289, 0.1525, 0.15209, 0.15166,
            0.1512, 0.15073, 0.15024, 0.14973, 0.14921, 0.14867, 0.14813, 0.14759,
            0.14704, 0.14649, 0.14593, 0.14538, 0.14484, 0.14429, 0.14376, 0.14325,
            0.14274, 0.14226, 0.14179, 0.14134, 0.14092, 0.14051, 0.14012, 0.13975,
            0.1394, 0.13906, 0.13873, 0.13841, 0.1381, 0.1378, 0.13751, 0.13724,
            0.13697, 0.13671, 0.13646, 0.13622, 0.13599, 0.13576, 0.13555, 0.13535,
            0.13515, 0.13497, 0.13479, 0.13462, 0.13446, 0.13431, 0.13417, 0.13405,
            0.13393, 0.13382, 0.13373, 0.13364, 0.13355, 0.13346, 0.13338, 0.1333,
            0.13322, 0.13314, 0.13306, 0.13298, 0.13289, 0.13279, 0.1327, 0.1326,
            0.13251
        ];

        $girlLBmi = [
            -2.12009, -2.10936, -2.09862, -2.08789, -2.07715, -2.06641, -2.05569,
            -2.04497, -2.03426, -2.02355, -2.01285, -2.00215, -1.99143, -1.9807,
            -1.96994, -1.95915, -1.94832, -1.93745, -1.92654, -1.91559, -1.90459,
            -1.89355, -1.88247, -1.87135, -1.8602, -1.84902, -1.8378, -1.82656,
            -1.81527, -1.80395, -1.7926, -1.78121, -1.76979, -1.75835, -1.7469,
            -1.73546, -1.72405, -1.71267, -1.70133, -1.69004, -1.67882, -1.66768,
            -1.65662, -1.64564, -1.63476, -1.62399, -1.61333, -1.6028, -1.59241,
            -1.58218, -1.57213, -1.56226, -1.55259, -1.54313, -1.5339, -1.52489,
            -1.51613, -1.50761, -1.49936, -1.49139, -1.4837, -1.47631, -1.46923,
            -1.46249, -1.45611, -1.45011, -1.44453, -1.43939, -1.43472, -1.43052,
            -1.42682, -1.42363, -1.42093, -1.41875, -1.41706, -1.41587, -1.41517,
            -1.41496, -1.41523, -1.41598, -1.4172, -1.41889, -1.42106, -1.42371,
            -1.42683, -1.43044, -1.43451, -1.43903, -1.44398, -1.44935, -1.4551,
            -1.46119, -1.46759, -1.47425, -1.48114, -1.4882, -1.4954, -1.5027,
            -1.51008, -1.5175, -1.52495, -1.5324, -1.53984, -1.54724, -1.55459,
            -1.56188, -1.56909, -1.57623, -1.58329, -1.59026, -1.59713, -1.6039,
            -1.61056, -1.61711, -1.62354, -1.62985, -1.63602, -1.64207, -1.64796,
            -1.6537, -1.65928, -1.66468, -1.66993, -1.675, -1.67991, -1.68465,
            -1.68925, -1.6937, -1.69801, -1.70222, -1.70631, -1.71032, -1.71423,
            -1.71808, -1.72186, -1.72558, -1.72925, -1.73287, -1.73647, -1.74004,
            -1.74361, -1.74717, -1.75072, -1.75428, -1.75783
        ];

        $girlMBmi = [
            15.31604, 15.35208, 15.38814, 15.42419, 15.46021, 15.49619, 15.53209,
            15.56788, 15.60355, 15.63911, 15.67459, 15.71004, 15.74546, 15.78092,
            15.81645, 15.85209, 15.88786, 15.92377, 15.95986, 15.99612, 16.03256,
            16.06918, 16.106, 16.143, 16.18021, 16.21762, 16.25524, 16.29312,
            16.33131, 16.36986, 16.40881, 16.44819, 16.48802, 16.52829, 16.56896,
            16.60998, 16.65132, 16.69294, 16.73485, 16.77704, 16.81949, 16.86222,
            16.90526, 16.94866, 16.99244, 17.03665, 17.08131, 17.12646, 17.17208,
            17.21814, 17.26464, 17.31155, 17.35887, 17.40659, 17.45471, 17.50319,
            17.55205, 17.60134, 17.65111, 17.7014, 17.75227, 17.80377, 17.85597,
            17.90891, 17.96266, 18.0173, 18.07284, 18.12926, 18.18649, 18.24442,
            18.30293, 18.36191, 18.42126, 18.48083, 18.54049, 18.6001, 18.65954,
            18.71869, 18.7774, 18.83556, 18.89303, 18.94977, 19.00575, 19.061,
            19.11549, 19.16919, 19.22209, 19.27416, 19.32542, 19.37585, 19.42542,
            19.47407, 19.52178, 19.56845, 19.61399, 19.65829, 19.70131, 19.74303,
            19.78343, 19.82254, 19.86041, 19.8971, 19.9326, 19.96695, 20.00013,
            20.0322, 20.06318, 20.09314, 20.12211, 20.15015, 20.17728, 20.20353,
            20.22892, 20.25347, 20.27723, 20.30023, 20.32248, 20.34401, 20.3648,
            20.38484, 20.40413, 20.4227, 20.44055, 20.45771, 20.4742, 20.49006,
            20.50533, 20.52006, 20.53429, 20.54809, 20.56149, 20.57456, 20.58732,
            20.59981, 20.61208, 20.62414, 20.636, 20.64771, 20.65932, 20.67086,
            20.68237, 20.69385, 20.70531, 20.71677, 20.72822
        ];

        $girlSBmi = [
            0.11425, 0.11511, 0.11596, 0.11682, 0.11767, 0.11852, 0.11937, 0.12022,
            0.12106, 0.1219, 0.12274, 0.12358, 0.12441, 0.12524, 0.12606, 0.12688,
            0.1277, 0.12851, 0.12933, 0.13014, 0.13094, 0.13175, 0.13255, 0.13335,
            0.13415, 0.13495, 0.13574, 0.13653, 0.13731, 0.13809, 0.13886, 0.13963,
            0.14038, 0.14113, 0.14186, 0.14257, 0.14328, 0.14397, 0.14465, 0.14531,
            0.14597, 0.14661, 0.14723, 0.14784, 0.14843, 0.14901, 0.14956, 0.1501,
            0.15061, 0.1511, 0.15157, 0.15201, 0.15242, 0.15281, 0.15316, 0.15347,
            0.15375, 0.15399, 0.15419, 0.15435, 0.15446, 0.15453, 0.15456, 0.15455,
            0.15449, 0.1544, 0.15426, 0.15409, 0.15387, 0.15363, 0.15334, 0.15303,
            0.15269, 0.15232, 0.15193, 0.15151, 0.15108, 0.15062, 0.15015, 0.14966,
            0.14915, 0.14863, 0.1481, 0.14755, 0.14699, 0.14641, 0.14582, 0.14522,
            0.14461, 0.14398, 0.14335, 0.1427, 0.14205, 0.14139, 0.14073, 0.14007,
            0.13942, 0.13877, 0.13814, 0.13752, 0.1369, 0.13631, 0.13572, 0.13516,
            0.13461, 0.13407, 0.13356, 0.13306, 0.13258, 0.13212, 0.13167, 0.13124,
            0.13082, 0.13042, 0.13004, 0.12967, 0.12931, 0.12897, 0.12864, 0.12833,
            0.12802, 0.12773, 0.12746, 0.12719, 0.12693, 0.12669, 0.12645, 0.12622,
            0.126, 0.12579, 0.12558, 0.12538, 0.12519, 0.12499, 0.12481, 0.12462,
            0.12444, 0.12426, 0.12409, 0.12391, 0.12374, 0.12356, 0.12339, 0.12321,
            0.12304
        ];

        if ($sex == self::MALE) {
            return [
                'L' => $boyLBmi[$elementx],
                'M' => $boyMBMI[$elementx],
                'S' => $boySBMI[$elementx]
            ];
        } else {
            return [
                'L' => $girlLBmi[$elementx],
                'M' => $girlMBmi[$elementx],
                'S' => $girlSBmi[$elementx]
            ];
        }
    }

    /**
     * @param     $elementx
     * @param int $sex
     *
     * @return array
     */
    protected function getHeightLms($elementx, $sex = self::FEMALE)
    {
        $boyGirlLHeight = [145];
        for ($i = 0; $i < 144; $i++) {
            $boyGirlLHeight[$i] = 1;
        }

        $boyMHeight = [
            121.7548, 122.2139, 122.677, 123.1449, 123.6177, 124.095, 124.5763,
            125.061, 125.5488, 126.0394, 126.5329, 127.0291, 127.5272, 128.0268,
            128.527, 129.0263, 129.5233, 130.0173, 130.5084, 130.997, 131.4837,
            131.9689, 132.4533, 132.9371, 133.42, 133.9019, 134.3822, 134.8598,
            135.334, 135.8043, 136.27, 136.7305, 137.1852, 137.6339, 138.0768,
            138.5145, 138.9472, 139.3754, 139.7994, 140.2197, 140.6373, 141.0533,
            141.4685, 141.8842, 142.3013, 142.7208, 143.1437, 143.5714, 144.0049,
            144.4447, 144.8913, 145.3448, 145.8054, 146.2734, 146.749, 147.2322,
            147.7231, 148.2215, 148.7265, 149.2373, 149.7527, 150.2719, 150.7945,
            151.3213, 151.8537, 152.3931, 152.9406, 153.4971, 154.0643, 154.6429,
            155.2331, 155.834, 156.4441, 157.062, 157.6858, 158.3139, 158.9442,
            159.5747, 160.2044, 160.8319, 161.4555, 162.0735, 162.6843, 163.2866,
            163.8791, 164.4609, 165.0318, 165.5922, 166.1424, 166.6823, 167.2116,
            167.73, 168.2371, 168.7321, 169.2141, 169.6821, 170.1349, 170.5715,
            170.991, 171.3933, 171.7787, 172.1474, 172.4996, 172.8362, 173.1582,
            173.4662, 173.7611, 174.0437, 174.3148, 174.5748, 174.8242, 175.0638,
            175.2938, 175.5147, 175.7266, 175.9296, 176.1237, 176.3093, 176.4861,
            176.6545, 176.8143, 176.9656, 177.1085, 177.2433, 177.3705, 177.4904,
            177.6036, 177.7105, 177.8119, 177.9084, 178.0007, 178.0897, 178.1761,
            178.2607, 178.344, 178.4268, 178.5095, 178.5924, 178.6756, 178.7592,
            178.8431, 178.9272, 179.0114, 179.0956, 179.1798
        ];

        $boySHeight = [
            0.04013, 0.04022, 0.04032, 0.04041, 0.04051, 0.04062, 0.04072, 0.04083,
            0.04094, 0.04106, 0.04118, 0.0413, 0.04143, 0.04156, 0.04169, 0.04182,
            0.04196, 0.0421, 0.04224, 0.04239, 0.04253, 0.04269, 0.04284, 0.043,
            0.04316, 0.04332, 0.04349, 0.04365, 0.04381, 0.04397, 0.04413, 0.04428,
            0.04443, 0.04458, 0.04472, 0.04486, 0.04499, 0.04511, 0.04524, 0.04536,
            0.04547, 0.04558, 0.04569, 0.0458, 0.04591, 0.04602, 0.04613, 0.04624,
            0.04636, 0.04649, 0.04662, 0.04677, 0.04692, 0.04708, 0.04726, 0.04745,
            0.04764, 0.04785, 0.04806, 0.04828, 0.04851, 0.04874, 0.04897, 0.04919,
            0.04942, 0.04964, 0.04985, 0.05006, 0.05025, 0.05044, 0.05061, 0.05076,
            0.05089, 0.051, 0.05109, 0.05114, 0.05117, 0.05117, 0.05113, 0.05106,
            0.05096, 0.05082, 0.05064, 0.05043, 0.05019, 0.04991, 0.0496, 0.04927,
            0.04891, 0.04853, 0.04813, 0.04772, 0.0473, 0.04687, 0.04643, 0.04599,
            0.04556, 0.04512, 0.04468, 0.04426, 0.04384, 0.04343, 0.04303, 0.04264,
            0.04227, 0.04191, 0.04156, 0.04123, 0.0409, 0.04059, 0.04029, 0.04001,
            0.03973, 0.03947, 0.03922, 0.03897, 0.03874, 0.03852, 0.03831, 0.03811,
            0.03792, 0.03774, 0.03757, 0.03741, 0.03726, 0.03712, 0.03698, 0.03686,
            0.03674, 0.03662, 0.03651, 0.03641, 0.0363, 0.0362, 0.0361, 0.03601,
            0.03591, 0.03581, 0.03571, 0.03561, 0.03551, 0.03541, 0.03531, 0.03521,
            0.03512
        ];

        $girlMHeight = [
            119.6026, 120.1792, 120.7541, 121.3259, 121.8941, 122.459, 123.0195,
            123.5742, 124.1223, 124.6635, 125.1982, 125.7278, 126.254, 126.7779,
            127.3002, 127.8211, 128.34, 128.856, 129.3683, 129.8761, 130.3797,
            130.8797, 131.3766, 131.8703, 132.3612, 132.8497, 133.3355, 133.8188,
            134.2984, 134.7738, 135.2446, 135.7099, 136.1699, 136.6257, 137.0787,
            137.5303, 137.9827, 138.4379, 138.8976, 139.3622, 139.8318, 140.3059,
            140.7839, 141.266, 141.754, 142.2491, 142.7522, 143.2642, 143.7864,
            144.3197, 144.8646, 145.4202, 145.9845, 146.5556, 147.1313, 147.7087,
            148.2858, 148.8604, 149.4305, 149.9943, 150.5522, 151.1057, 151.6556,
            152.2021, 152.7448, 153.2825, 153.8132, 154.3347, 154.8447, 155.3409,
            155.8219, 156.2865, 156.7345, 157.1655, 157.5796, 157.9772, 158.3591,
            158.7256, 159.0773, 159.4142, 159.7368, 160.0454, 160.3403, 160.6219,
            160.8905, 161.1462, 161.3894, 161.62, 161.8382, 162.0439, 162.2376,
            162.4194, 162.5897, 162.7487, 162.8967, 163.0342, 163.1617, 163.2798,
            163.3888, 163.4892, 163.5814, 163.6659, 163.7435, 163.8146, 163.8799,
            163.9402, 163.9961, 164.0483, 164.0976, 164.1444, 164.189, 164.2318,
            164.273, 164.3127, 164.3511, 164.3882, 164.4241, 164.4589, 164.4925,
            164.5252, 164.5571, 164.5883, 164.6192, 164.6499, 164.6808, 164.7122,
            164.7437, 164.7753, 164.8067, 164.8376, 164.8679, 164.8972, 164.9254,
            164.9521, 164.9774, 165.0011, 165.0228, 165.0424, 165.0598, 165.0753,
            165.0892, 165.1019, 165.1135, 165.1246, 165.1355
        ];

        $girlSHeight = [
            0.04067, 0.04088, 0.04109, 0.04130, 0.04151, 0.04171, 0.04191, 0.04211,
            0.04230, 0.04249, 0.04267, 0.04286, 0.04303, 0.04321, 0.04338, 0.04354,
            0.04371, 0.04387, 0.04403, 0.04418, 0.04433, 0.04448, 0.04463, 0.04477,
            0.04491, 0.04505, 0.04518, 0.04532, 0.04545, 0.04558, 0.04571, 0.04584,
            0.04597, 0.04609, 0.04622, 0.04634, 0.04646, 0.04658, 0.04669, 0.04680,
            0.04691, 0.04701, 0.04710, 0.04718, 0.04726, 0.04732, 0.04737, 0.04741,
            0.04743, 0.04743, 0.04742, 0.04739, 0.04733, 0.04726, 0.04717, 0.04705,
            0.04691, 0.04674, 0.04655, 0.04634, 0.04610, 0.04585, 0.04558, 0.04529,
            0.04499, 0.04468, 0.04436, 0.04403, 0.04370, 0.04337, 0.04304, 0.04271,
            0.04238, 0.04207, 0.04175, 0.04145, 0.04116, 0.04087, 0.04059, 0.04033,
            0.04007, 0.03982, 0.03958, 0.03935, 0.03913, 0.03892, 0.03873, 0.03854,
            0.03836, 0.03819, 0.03803, 0.03788, 0.03774, 0.03761, 0.03749, 0.03738,
            0.03727, 0.03718, 0.03709, 0.03701, 0.03693, 0.03687, 0.03680, 0.03675,
            0.03669, 0.03664, 0.03660, 0.03656, 0.03652, 0.03648, 0.03644, 0.03641,
            0.03638, 0.03635, 0.03632, 0.03629, 0.03626, 0.03623, 0.03620, 0.03618,
            0.03615, 0.03613, 0.03610, 0.03608, 0.03605, 0.03603, 0.03600, 0.03598,
            0.03595, 0.03593, 0.03591, 0.03588, 0.03586, 0.03584, 0.03582, 0.03580,
            0.03578, 0.03577, 0.03575, 0.03574, 0.03573, 0.03572, 0.03571, 0.03570,
            0.03569
        ];

        if ($sex == self::MALE) {
            return [
                'L' => $boyGirlLHeight[$elementx],
                'M' => $boyMHeight[$elementx],
                'S' => $boySHeight[$elementx]
            ];
        } else {
            return [
                'L' => $boyGirlLHeight[$elementx],
                'M' => $girlMHeight[$elementx],
                'S' => $girlSHeight[$elementx]
            ];
        }
    }

    /**
     * @param     $elementx
     * @param int $sex
     *
     * @return array
     */
    protected function getWeightLms($elementx, $sex = self::FEMALE)
    {
        $boyLWeight = [
            -1.40477, -1.39486, -1.38494, -1.375, -1.36504, -1.35507, -1.34509,
            -1.33509, -1.32507, -1.31504, -1.305, -1.29495, -1.28487, -1.27478,
            -1.26467, -1.25454, -1.2444, -1.23426, -1.22411, -1.21395, -1.20378,
            -1.1936, -1.18339, -1.17316, -1.16291, -1.15263, -1.14231, -1.13197,
            -1.12159, -1.11119, -1.10075, -1.09027, -1.07977, -1.06925, -1.0587,
            -1.04813, -1.03753, -1.0269, -1.01625, -1.00557, -0.99486, -0.98412,
            -0.97334, -0.96252, -0.95165, -0.94075, -0.92981, -0.91882, -0.9078,
            -0.89674, -0.88564, -0.87452, -0.86336, -0.85218, -0.84099, -0.82979,
            -0.81859, -0.8074, -0.79623, -0.78509, -0.77399, -0.76296, -0.75199,
            -0.74113, -0.73037, -0.71976, -0.70931, -0.69905, -0.689, -0.67917,
            -0.66959, -0.66028, -0.65127, -0.64256, -0.63419, -0.62617, -0.61851,
            -0.61123, -0.60434, -0.59785, -0.59178, -0.58613, -0.58091, -0.57613,
            -0.57179, -0.56789, -0.56442, -0.56139, -0.55878, -0.55659, -0.55483,
            -0.55347, -0.55254, -0.55203, -0.55192, -0.55222, -0.55289, -0.55393,
            -0.55532, -0.55705, -0.5591, -0.56144, -0.56405, -0.56691, -0.57001,
            -0.5733, -0.57679, -0.58044, -0.58423, -0.58816, -0.5922, -0.59635,
            -0.60058, -0.6049, -0.60927, -0.61369, -0.61815, -0.62263, -0.62713,
            -0.63163, -0.63612, -0.6406, -0.64505, -0.64947, -0.65385, -0.6582,
            -0.6625, -0.66677, -0.67099, -0.67516, -0.67929, -0.68338, -0.68743,
            -0.69144, -0.69541, -0.69934, -0.70325, -0.70714, -0.711, -0.71485,
            -0.71869, -0.72252, -0.72634, -0.73016, -0.73398
        ];

        $boyMWeight = [
            22.89787, 23.15387, 23.41032, 23.66737, 23.92507, 24.18343, 24.44245,
            24.7021, 24.96237, 25.22318, 25.48455, 25.74649, 26.00909, 26.2724,
            26.53635, 26.80074, 27.06534, 27.33003, 27.59478, 27.85966, 28.12473,
            28.39021, 28.65631, 28.92315, 29.19084, 29.4595, 29.72922, 30.00006,
            30.27208, 30.54539, 30.82004, 31.09597, 31.37318, 31.65161, 31.93124,
            32.2122, 32.49466, 32.7788, 33.06477, 33.35275, 33.6431, 33.93614,
            34.23216, 34.53146, 34.83434, 35.14106, 35.4519, 35.76715, 36.08704,
            36.41167, 36.74112, 37.07546, 37.4147, 37.75893, 38.1082, 38.4626,
            38.82225, 39.18727, 39.55762, 39.93323, 40.31407, 40.70012, 41.09136,
            41.48792, 41.89004, 42.29792, 42.71168, 43.13142, 43.55723, 43.98914,
            44.42703, 44.87062, 45.31951, 45.7733, 46.23164, 46.69422, 47.16059,
            47.6302, 48.10255, 48.57705, 49.05309, 49.53004, 50.00716, 50.48384,
            50.95954, 51.43383, 51.90648, 52.37742, 52.84644, 53.31326, 53.77756,
            54.23897, 54.69719, 55.15173, 55.60216, 56.048, 56.48874, 56.92384,
            57.35283, 57.77538, 58.19119, 58.60011, 59.00206, 59.39713, 59.78547,
            60.16719, 60.54243, 60.91136, 61.27414, 61.63089, 61.98184, 62.32716,
            62.66702, 63.00151, 63.3307, 63.65461, 63.9733, 64.28679, 64.59512,
            64.89835, 65.19648, 65.48944, 65.77732, 66.0602, 66.33825, 66.61167,
            66.88072, 67.14568, 67.40685, 67.66453, 67.91895, 68.17037, 68.41905,
            68.66525, 68.90926, 69.15141, 69.39192, 69.63109, 69.86917, 70.10629,
            70.34269, 70.57848, 70.8138, 71.04882, 71.28365
        ];

        $boySWeight = [
            0.16827, 0.16919, 0.17012, 0.17105, 0.17198, 0.17291, 0.17385, 0.17479,
            0.17573, 0.17667, 0.17762, 0.17857, 0.17953, 0.18048, 0.18144, 0.1824,
            0.18336, 0.18433, 0.18529, 0.18626, 0.18722, 0.18819, 0.18915, 0.19012,
            0.19108, 0.19205, 0.19301, 0.19398, 0.19494, 0.1959, 0.19685, 0.1978,
            0.19874, 0.19967, 0.2006, 0.20152, 0.20243, 0.20333, 0.20423, 0.20511,
            0.20598, 0.20683, 0.20768, 0.2085, 0.20932, 0.21012, 0.2109, 0.21166,
            0.21241, 0.21313, 0.21384, 0.21452, 0.21517, 0.2158, 0.21641, 0.21698,
            0.21752, 0.21802, 0.21849, 0.21892, 0.2193, 0.21964, 0.21993, 0.22017,
            0.22035, 0.22048, 0.22054, 0.22055, 0.2205, 0.22038, 0.2202, 0.21995,
            0.21964, 0.21926, 0.21882, 0.21831, 0.21773, 0.21708, 0.21637, 0.2156,
            0.21476, 0.21385, 0.21289, 0.21187, 0.21079, 0.20967, 0.20849, 0.20727,
            0.20601, 0.20471, 0.20337, 0.20201, 0.20062, 0.19922, 0.19779, 0.19636,
            0.19493, 0.19349, 0.19206, 0.19063, 0.18921, 0.18781, 0.18643, 0.18507,
            0.18372, 0.1824, 0.1811, 0.17983, 0.17858, 0.17735, 0.17615, 0.17497,
            0.17382, 0.17269, 0.17158, 0.1705, 0.16944, 0.16841, 0.1674, 0.16641,
            0.16544, 0.16449, 0.16357, 0.16267, 0.16179, 0.16092, 0.16008, 0.15926,
            0.15845, 0.15765, 0.15688, 0.15611, 0.15535, 0.15461, 0.15387, 0.15314,
            0.15241, 0.15169, 0.15097, 0.15026, 0.14954, 0.14883, 0.14812, 0.14741,
            0.1467
        ];

        $girlLWeight = [
            -1.06604, -1.06575, -1.06546, -1.06516, -1.06486, -1.06456, -1.06423,
            -1.06387, -1.06343, -1.0629, -1.06224, -1.06142, -1.0604, -1.05916,
            -1.05766, -1.05586, -1.05374, -1.05127, -1.04842, -1.04515, -1.04147,
            -1.03736, -1.03279, -1.02775, -1.02223, -1.01621, -1.00968, -1.00265,
            -0.99512, -0.98707, -0.97852, -0.96948, -0.95998, -0.95004, -0.93966,
            -0.92887, -0.91769, -0.90615, -0.8943, -0.88217, -0.86978, -0.85716,
            -0.84429, -0.83119, -0.81783, -0.80422, -0.79036, -0.77626, -0.76199,
            -0.7476, -0.73317, -0.71877, -0.70449, -0.69041, -0.67658, -0.66304,
            -0.64983, -0.637, -0.62463, -0.61273, -0.60133, -0.59043, -0.5801,
            -0.57039, -0.56141, -0.55328, -0.5461, -0.53997, -0.53496, -0.53112,
            -0.52843, -0.52687, -0.5264, -0.52701, -0.52868, -0.53141, -0.5352,
            -0.54008, -0.54604, -0.55313, -0.56136, -0.57077, -0.5814, -0.59329,
            -0.60643, -0.62075, -0.63617, -0.65256, -0.6698, -0.68775, -0.70624,
            -0.7251, -0.74417, -0.76332, -0.78238, -0.80123, -0.81977, -0.83792,
            -0.85559, -0.87276, -0.88937, -0.90542, -0.92089, -0.93577, -0.95006,
            -0.96377, -0.97692, -0.98953, -1.00163, -1.01324, -1.02439, -1.03509,
            -1.04536, -1.05522, -1.06469, -1.0738, -1.08256, -1.09098, -1.09905,
            -1.10678, -1.11416, -1.1212, -1.12792, -1.13433, -1.14044, -1.14627,
            -1.15184, -1.15714, -1.16221, -1.16706, -1.17172, -1.1762, -1.18051,
            -1.18467, -1.1887, -1.1926, -1.19637, -1.2, -1.20354, -1.207, -1.2104,
            -1.21376, -1.21708, -1.2204, -1.22371
        ];

        $girlMWeight = [
            21.89787, 22.16066, 22.42366, 22.68666, 22.94966, 23.21273, 23.4756,
            23.73776, 23.99904, 24.25944, 24.51929, 24.77901, 25.03903, 25.2998,
            25.5617, 25.82496, 26.08944, 26.355, 26.62164, 26.88927, 27.15789,
            27.42771, 27.69894, 27.9716, 28.24568, 28.52119, 28.79814, 29.07668,
            29.35694, 29.63908, 29.92326, 30.20963, 30.49842, 30.78988, 31.08398,
            31.3806, 31.67992, 31.98237, 32.28846, 32.59841, 32.91232, 33.23032,
            33.55261, 33.87951, 34.21155, 34.5493, 34.8933, 35.24393, 35.60132,
            35.96536, 36.33591, 36.71253, 37.09465, 37.48191, 37.8737, 38.26929,
            38.66823, 39.07041, 39.47565, 39.88358, 40.29416, 40.70758, 41.12392,
            41.54318, 41.96537, 42.39029, 42.81717, 43.24508, 43.67265, 44.09834,
            44.52077, 44.93883, 45.3515, 45.75766, 46.15646, 46.54722, 46.92947,
            47.30284, 47.66689, 48.02123, 48.3656, 48.70005, 49.02486, 49.34044,
            49.64708, 49.94474, 50.23353, 50.5135, 50.78462, 51.04689, 51.3003,
            51.54475, 51.78022, 52.0066, 52.22369, 52.4314, 52.62983, 52.81916,
            52.99962, 53.17148, 53.33514, 53.49103, 53.63943, 53.7806, 53.91486,
            54.04257, 54.16413, 54.27993, 54.39043, 54.49594, 54.59679, 54.69317,
            54.78532, 54.87352, 54.95803, 55.03906, 55.11681, 55.19137, 55.26274,
            55.33092, 55.39595, 55.45791, 55.51697, 55.57325, 55.62686, 55.67794,
            55.72665, 55.77307, 55.81736, 55.85978, 55.90045, 55.93952, 55.97713,
            56.01345, 56.0486, 56.08259, 56.11538, 56.14707, 56.17787, 56.20797,
            56.23759, 56.26684, 56.29581, 56.32468, 56.35349
        ];

        $girlSWeight = [
            0.16365, 0.16477, 0.16589, 0.167, 0.16811, 0.16921, 0.1703, 0.17138,
            0.17245, 0.1735, 0.17455, 0.17558, 0.17661, 0.17762, 0.17862, 0.17961,
            0.1806, 0.18157, 0.18254, 0.18351, 0.18447, 0.18543, 0.18639, 0.18735,
            0.1883, 0.18925, 0.19021, 0.19116, 0.19212, 0.19307, 0.19403, 0.19499,
            0.19594, 0.19688, 0.19781, 0.19874, 0.19966, 0.20057, 0.20147, 0.20237,
            0.20326, 0.20414, 0.20501, 0.20586, 0.2067, 0.20752, 0.20831, 0.20908,
            0.20982, 0.21052, 0.21119, 0.2118, 0.21236, 0.21286, 0.21327, 0.2136,
            0.21382, 0.21393, 0.21392, 0.21378, 0.21352, 0.21314, 0.21263, 0.21202,
            0.21129, 0.21046, 0.20953, 0.20852, 0.20742, 0.20625, 0.20502, 0.20372,
            0.20238, 0.20099, 0.19957, 0.1981, 0.19661, 0.19509, 0.19355, 0.19198,
            0.19039, 0.18879, 0.18718, 0.18555, 0.18392, 0.18227, 0.18063, 0.179,
            0.17738, 0.17578, 0.1742, 0.17266, 0.17115, 0.16969, 0.16827, 0.16691,
            0.1656, 0.16435, 0.16316, 0.16202, 0.16094, 0.15992, 0.15894, 0.15802,
            0.15715, 0.15633, 0.15555, 0.15482, 0.15412, 0.15346, 0.15283, 0.15224,
            0.15167, 0.15113, 0.15062, 0.15013, 0.14966, 0.14921, 0.14879, 0.14838,
            0.14799, 0.14763, 0.14728, 0.14695, 0.14663, 0.14633, 0.14605, 0.14577,
            0.14551, 0.14527, 0.14503, 0.1448, 0.14458, 0.14437, 0.14416, 0.14396,
            0.14377, 0.14359, 0.14341, 0.14323, 0.14306, 0.14289, 0.14272, 0.14255,
            0.14239
        ];

        if ($sex == self::MALE) {
            return [
                'L' => $boyLWeight[$elementx],
                'M' => $boyMWeight[$elementx],
                'S' => $boySWeight[$elementx]
            ];
        } else {
            return [
                'L' => $girlLWeight[$elementx],
                'M' => $girlMWeight[$elementx],
                'S' => $girlSWeight[$elementx]
            ];
        }
    }

    /**
     * @param     $elementx
     * @param int $sex
     *
     * @return array
     */
    protected function getSbpLms($elementx, $sex = self::FEMALE)
    {
        $boyLSbp = [145];
        for ($i = 0; $i < 144; $i++) {
            $boyLSbp[$i] = 0.05608;
        }

        $boyMSbp = [
            100.97030, 101.04330, 101.11640, 101.18970, 101.26310, 101.33670,
            101.41060, 101.48460, 101.55890, 101.63350, 101.70860, 101.78450,
            101.86130, 101.93920, 102.01830, 102.09870, 102.18050, 102.26380,
            102.34860, 102.43500, 102.52290, 102.61240, 102.70330, 102.79570,
            102.88950, 102.98450, 103.08070, 103.17770, 103.27550, 103.37380,
            103.47230, 103.57100, 103.66960, 103.76800, 103.86610, 103.96360,
            104.06060, 104.15700, 104.25280, 104.34810, 104.44300, 104.53760,
            104.63200, 104.72640, 104.82100, 104.91590, 105.01150, 105.10810,
            105.20600, 105.30550, 105.40680, 105.51040, 105.61640, 105.72520,
            105.83690, 105.95200, 106.07050, 106.19270, 106.31870, 106.44850,
            106.58230, 106.71990, 106.86170, 107.00770, 107.15860, 107.31480,
            107.47670, 107.64460, 107.81910, 108.00040, 108.18860, 108.38370,
            108.58540, 108.79340, 109.00760, 109.22840, 109.45580, 109.68980,
            109.93050, 110.17780, 110.43150, 110.69120, 110.95670, 111.22750,
            111.50310, 111.78270, 112.06610, 112.35250, 112.64140, 112.93260,
            113.22570, 113.52040, 113.81600, 114.11160, 114.40600, 114.69740,
            114.98430, 115.26480, 115.53740, 115.80080, 116.05390, 116.29570,
            116.52550, 116.74300, 116.94830, 117.14150, 117.32310, 117.49360,
            117.65380, 117.80470, 117.94730, 118.08260, 118.21130, 118.33420,
            118.45190, 118.56490, 118.67370, 118.77880, 118.88060, 118.97950,
            119.07570, 119.16940, 119.26060, 119.34980, 119.43700, 119.52260,
            119.60670, 119.68940, 119.77090, 119.85140, 119.93070, 120.00920,
            120.08680, 120.16360, 120.23980, 120.31530, 120.39020, 120.46440,
            120.53800, 120.61100, 120.68350, 120.75570, 120.82750, 120.89920,
            120.97080
        ];

        $boySSbp = [
            0.08515, 0.08518, 0.08521, 0.08524, 0.08527, 0.08530, 0.08533, 0.08536,
            0.08539, 0.08542, 0.08545, 0.08549, 0.08552, 0.08555, 0.08558, 0.08562,
            0.08565, 0.08569, 0.08572, 0.08576, 0.08579, 0.08583, 0.08587, 0.08590,
            0.08594, 0.08598, 0.08602, 0.08606, 0.08610, 0.08614, 0.08618, 0.08622,
            0.08626, 0.08630, 0.08634, 0.08638, 0.08642, 0.08646, 0.08651, 0.08655,
            0.08659, 0.08663, 0.08667, 0.08671, 0.08676, 0.08680, 0.08684, 0.08689,
            0.08693, 0.08698, 0.08702, 0.08707, 0.08712, 0.08717, 0.08722, 0.08728,
            0.08733, 0.08739, 0.08745, 0.08751, 0.08757, 0.08763, 0.08769, 0.08776,
            0.08783, 0.08790, 0.08797, 0.08804, 0.08812, 0.08820, 0.08828, 0.08836,
            0.08844, 0.08852, 0.08861, 0.08870, 0.08879, 0.08888, 0.08897, 0.08906,
            0.08916, 0.08925, 0.08935, 0.08945, 0.08954, 0.08964, 0.08974, 0.08984,
            0.08994, 0.09004, 0.09014, 0.09024, 0.09034, 0.09044, 0.09053, 0.09063,
            0.09073, 0.09082, 0.09092, 0.09101, 0.09110, 0.09119, 0.09127, 0.09136,
            0.09144, 0.09152, 0.09160, 0.09167, 0.09174, 0.09181, 0.09188, 0.09195,
            0.09201, 0.09207, 0.09213, 0.09219, 0.09225, 0.09230, 0.09236, 0.09241,
            0.09246, 0.09251, 0.09256, 0.09261, 0.09265, 0.09270, 0.09274, 0.09279,
            0.09283, 0.09288, 0.09292, 0.09296, 0.09300, 0.09304, 0.09309, 0.09313,
            0.09317, 0.09321, 0.09325, 0.09329, 0.09333, 0.09336, 0.09340, 0.09344,
            0.09348
        ];

        $girlLSbp = [145];
        for ($i = 0; $i < 144; $i++) {
            $girlLSbp[$i] = -0.12619;
        }

        $girlMSbp = [
            100.1331, 100.2540, 100.3748, 100.4956, 100.6162, 100.7367, 100.8571,
            100.9772, 101.0970, 101.2164, 101.3355, 101.4542, 101.5725, 101.6902,
            101.8075, 101.9243, 102.0407, 102.1569, 102.2731, 102.3893, 102.5057,
            102.6227, 102.7401, 102.8579, 102.9762, 103.0948, 103.2139, 103.3335,
            103.4537, 103.5747, 103.6964, 103.8190, 103.9425, 104.0668, 104.1920,
            104.3181, 104.4452, 104.5736, 104.7034, 104.8348, 104.9679, 105.1029,
            105.2400, 105.3792, 105.5208, 105.6647, 105.8111, 105.9600, 106.1112,
            106.2647, 106.4203, 106.5780, 106.7377, 106.8994, 107.0630, 107.2282,
            107.3949, 107.5629, 107.7320, 107.9020, 108.0726, 108.2438, 108.4151,
            108.5863, 108.7571, 108.9272, 109.0962, 109.2638, 109.4298, 109.5936,
            109.7551, 109.9139, 110.0697, 110.2223, 110.3714, 110.5169, 110.6586,
            110.7965, 110.9303, 111.0601, 111.1857, 111.3069, 111.4237, 111.5361,
            111.6439, 111.7471, 111.8457, 111.9395, 112.0286, 112.1131, 112.1929,
            112.2682, 112.3389, 112.4052, 112.4670, 112.5243, 112.5772, 112.6256,
            112.6696, 112.7095, 112.7451, 112.7767, 112.8042, 112.8279, 112.8477,
            112.8639, 112.8767, 112.8862, 112.8928, 112.8968, 112.8983, 112.8978,
            112.8954, 112.8914, 112.8859, 112.8791, 112.8713, 112.8627, 112.8533,
            112.8434, 112.8327, 112.8214, 112.8092, 112.7962, 112.7821, 112.7669,
            112.7506, 112.7331, 112.7145, 112.6947, 112.6739, 112.6520, 112.6289,
            112.6047, 112.5793, 112.5527, 112.5249, 112.4959, 112.4658, 112.4347,
            112.4027, 112.3698, 112.3364, 112.3027, 112.2689
        ];

        $girlSSbp = [145];
        for ($i = 0; $i < 144; $i++) {
            $girlSSbp[$i] = 0.08948;
        }

        if ($sex == self::MALE) {
            return [
                'L' => $boyLSbp[$elementx],
                'M' => $boyMSbp[$elementx],
                'S' => $boySSbp[$elementx]
            ];
        } else {
            return [
                'L' => $girlLSbp[$elementx],
                'M' => $girlMSbp[$elementx],
                'S' => $girlSSbp[$elementx]
            ];
        }
    }

    /**
     * @param     $elementx
     * @param int $sex
     *
     * @return array
     */
    protected function getDbpLms($elementx, $sex = self::FEMALE)
    {
        $boyLDbp = [145];
        for ($i = 0; $i < 144; $i++) {
            $boyLDbp[$i] = 0.51717;
        }

        $boyMDbp = [
            58.50575, 58.55668, 58.60749, 58.65810, 58.70844, 58.75846, 58.80812,
            58.85744, 58.90649, 58.95539, 59.00434, 59.05354, 59.10319, 59.15347,
            59.20446, 59.25615, 59.30853, 59.36161, 59.41533, 59.46964, 59.52441,
            59.57953, 59.63494, 59.69056, 59.74625, 59.80183, 59.85715, 59.91200,
            59.96609, 60.01913, 60.07087, 60.12109, 60.16959, 60.21618, 60.26070,
            60.30308, 60.34331, 60.38145, 60.41762, 60.45208, 60.48510, 60.51690,
            60.54770, 60.57768, 60.60703, 60.63593, 60.66455, 60.69302, 60.72143,
            60.74990, 60.77854, 60.80743, 60.83664, 60.86621, 60.89619, 60.92666,
            60.95765, 60.98918, 61.02123, 61.05379, 61.08683, 61.12031, 61.15422,
            61.18865, 61.22379, 61.25977, 61.29668, 61.33463, 61.37377, 61.41422,
            61.45603, 61.49925, 61.54390, 61.59005, 61.63780, 61.68732, 61.73877,
            61.79230, 61.84803, 61.90609, 61.96661, 62.02983, 62.09606, 62.16555,
            62.23840, 62.31465, 62.39443, 62.47791, 62.56522, 62.65645, 62.75163,
            62.85091, 62.95438, 63.06185, 63.17290, 63.28683, 63.40276, 63.51953,
            63.63606, 63.75161, 63.86571, 63.97783, 64.08736, 64.19373, 64.29645,
            64.39511, 64.48945, 64.57931, 64.66481, 64.74628, 64.82407, 64.89839,
            64.96941, 65.03725, 65.10203, 65.16383, 65.22279, 65.27909, 65.33295,
            65.38454, 65.43394, 65.48122, 65.52655, 65.57005, 65.61188, 65.65217,
            65.69104, 65.72859, 65.76496, 65.80025, 65.83452, 65.86787, 65.90039,
            65.93216, 65.96326, 65.99377, 66.02368, 66.05300, 66.08170, 66.10983,
            66.13743, 66.16457, 66.19131, 66.21777, 66.24401
        ];

        $boySDbp = [
            0.12331, 0.12329, 0.12327, 0.12325, 0.12323, 0.12321, 0.12319,
            0.12317, 0.12316, 0.12314, 0.12312, 0.12310, 0.12308, 0.12306,
            0.12304, 0.12302, 0.12301, 0.12299, 0.12297, 0.12295, 0.12293,
            0.12291, 0.12289, 0.12287, 0.12285, 0.12283, 0.12281, 0.12279,
            0.12277, 0.12275, 0.12273, 0.12271, 0.12270, 0.12268, 0.12266,
            0.12265, 0.12263, 0.12262, 0.12260, 0.12259, 0.12257, 0.12256,
            0.12255, 0.12253, 0.12252, 0.12251, 0.12250, 0.12248, 0.12247,
            0.12246, 0.12245, 0.12243, 0.12242, 0.12241, 0.12239, 0.12238,
            0.12237, 0.12235, 0.12234, 0.12232, 0.12231, 0.12229, 0.12228,
            0.12226, 0.12224, 0.12223, 0.12221, 0.12219, 0.12217, 0.12216,
            0.12214, 0.12212, 0.12210, 0.12208, 0.12205, 0.12203, 0.12201,
            0.12199, 0.12196, 0.12194, 0.12191, 0.12188, 0.12186, 0.12183,
            0.12180, 0.12177, 0.12174, 0.12171, 0.12168, 0.12165, 0.12162,
            0.12158, 0.12155, 0.12152, 0.12148, 0.12145, 0.12141, 0.12138,
            0.12134, 0.12131, 0.12127, 0.12124, 0.12120, 0.12117, 0.12114,
            0.12110, 0.12107, 0.12104, 0.12101, 0.12098, 0.12095, 0.12092,
            0.12089, 0.12086, 0.12083, 0.12081, 0.12078, 0.12076, 0.12073,
            0.12071, 0.12068, 0.12066, 0.12064, 0.12062, 0.12060, 0.12058,
            0.12056, 0.12054, 0.12052, 0.12050, 0.12048, 0.12046, 0.12045,
            0.12043, 0.12041, 0.12039, 0.12038, 0.12036, 0.12035, 0.12033,
            0.12031, 0.12030, 0.12028, 0.12027, 0.12025
        ];

        $girlLDbp = [145];
        for ($i = 0; $i < 144; $i++) {
            $girlLDbp[$i] = 0.63332;
        }

        $girlMDbp = [
            59.20734, 59.26272, 59.31804, 59.37326, 59.42838, 59.48336, 59.53816,
            59.59273, 59.64699, 59.70088, 59.75434, 59.80731, 59.85972, 59.91152,
            59.96265, 60.01309, 60.06286, 60.11203, 60.16068, 60.20888, 60.25679,
            60.30454, 60.35223, 60.39992, 60.44764, 60.49544, 60.54337, 60.59151,
            60.63992, 60.68864, 60.73770, 60.78705, 60.83667, 60.88651, 60.93653,
            60.98676, 61.03724, 61.08806, 61.13928, 61.19094, 61.24307, 61.29574,
            61.34902, 61.40295, 61.45762, 61.51310, 61.56945, 61.62669, 61.68473,
            61.74350, 61.80292, 61.86295, 61.92359, 61.98483, 62.04665, 62.10898,
            62.17174, 62.23491, 62.29846, 62.36236, 62.42659, 62.49115, 62.55603,
            62.62120, 62.68659, 62.75212, 62.81768, 62.88320, 62.94858, 63.01373,
            63.07856, 63.14299, 63.20698, 63.27046, 63.33341, 63.39578, 63.45753,
            63.51860, 63.57895, 63.63857, 63.69734, 63.75521, 63.81212, 63.86803,
            63.92286, 63.97656, 64.02906, 64.08028, 64.13016, 64.17861, 64.22561,
            64.27109, 64.31499, 64.35726, 64.39789, 64.43681, 64.47401, 64.50949,
            64.54331, 64.57554, 64.60624, 64.63548, 64.66335, 64.68992, 64.71529,
            64.73955, 64.76279, 64.78513, 64.80667, 64.82758, 64.84801, 64.86812,
            64.88808, 64.90806, 64.92819, 64.94867, 64.96966, 64.99129, 65.01363,
            65.03666, 65.06030, 65.08438, 65.10873, 65.13316, 65.15744, 65.18142,
            65.20496, 65.22790, 65.25017, 65.27174, 65.29260, 65.31274, 65.33213,
            65.35078, 65.36868, 65.38584, 65.40230, 65.41809, 65.43322, 65.44771,
            65.46165, 65.47517, 65.48843, 65.50159, 65.51473
        ];

        $girlSDbp = [
            0.12610, 0.12598, 0.12585, 0.12573, 0.12560, 0.12548, 0.12535,
            0.12523, 0.12511, 0.12498, 0.12486, 0.12473, 0.12461, 0.12448,
            0.12436, 0.12423, 0.12411, 0.12399, 0.12386, 0.12374, 0.12361,
            0.12349, 0.12336, 0.12324, 0.12312, 0.12299, 0.12287, 0.12274,
            0.12262, 0.12249, 0.12237, 0.12225, 0.12212, 0.12200, 0.12187,
            0.12175, 0.12162, 0.12150, 0.12137, 0.12125, 0.12113, 0.12100,
            0.12088, 0.12075, 0.12063, 0.12050, 0.12038, 0.12026, 0.12013,
            0.12001, 0.11988, 0.11976, 0.11963, 0.11951, 0.11939, 0.11926,
            0.11914, 0.11901, 0.11889, 0.11876, 0.11864, 0.11851, 0.11839,
            0.11827, 0.11814, 0.11802, 0.11789, 0.11777, 0.11764, 0.11752,
            0.11740, 0.11727, 0.11715, 0.11702, 0.11690, 0.11677, 0.11665,
            0.11653, 0.11640, 0.11628, 0.11615, 0.11603, 0.11590, 0.11578,
            0.11566, 0.11553, 0.11541, 0.11528, 0.11516, 0.11503, 0.11491,
            0.11478, 0.11466, 0.11454, 0.11441, 0.11429, 0.11416, 0.11404,
            0.11391, 0.11379, 0.11367, 0.11354, 0.11342, 0.11329, 0.11317,
            0.11304, 0.11292, 0.11280, 0.11267, 0.11255, 0.11242, 0.11230,
            0.11217, 0.11205, 0.11192, 0.11180, 0.11168, 0.11155, 0.11143,
            0.11130, 0.11118, 0.11105, 0.11093, 0.11081, 0.11068, 0.11056,
            0.11043, 0.11031, 0.11018, 0.11006, 0.10994, 0.10981, 0.10969,
            0.10956, 0.10944, 0.10931, 0.10919, 0.10906, 0.10894, 0.10882,
            0.10869, 0.10857, 0.10844, 0.10832, 0.10819
        ];

        if ($sex == self::MALE) {
            return [
                'L' => $boyLDbp[$elementx],
                'M' => $boyMDbp[$elementx],
                'S' => $boySDbp[$elementx]
            ];
        } else {
            return [
                'L' => $girlLDbp[$elementx],
                'M' => $girlMDbp[$elementx],
                'S' => $girlSDbp[$elementx]
            ];
        }
    }

    /**
     * @param $measure
     * @param $l
     * @param $m
     * @param $s
     *
     * @return float|int
     */
    protected function calculateZScore($measure, $l, $m, $s)
    {
        if ($l == 0) {
            $z = log($measure / $m) / $s;
        } else {
            $z = (pow(($measure / $m), $l) - 1) / ($l * $s);
        }

        return $z;
    }

    /**
     * @param $z
     *
     * @return int
     */
    protected function calculateCentile($z)
    {
        $p = 1 - 1 / sqrt(2 * 3.14159265) * exp(-pow(abs($z), 2) / 2)
            * (0.4361836 * (1 / (1 + 0.33267 * abs($z))) - 0.1201676
                * pow((1 / (1
                        + 0.33267
                        * abs($z))),
                    2) + 0.937298 * pow((1 / (1 + 0.33267 * abs($z))), 3));

        $centile = '';
        if ($z > 0) {
            $centile = $p * 100;
        } else {
            $centile = 100 - $p * 100;
        }

        return $centile;
    }

    /**
     * @param $n
     * @param $k
     *
     * @return float
     */
    protected function dec($n, $k)
    {
        $factor = pow(10, $k + 1);

        $n = round(round($n * $factor) / 10);

        return $n / ($factor / 10);
    }
}